<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrustCareConnect - Futuristic Healthcare Platform</title>
    <meta name="theme-color" content="#0f172a">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Include IC Agent for backend communication -->
    <script src="https://unpkg.com/@dfinity/agent@0.20.2/lib/cjs/index.js"></script>
    <!-- External Stylesheet -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">TrustCareConnect</div>
                <nav class="nav">
                    <a href="#" onclick="showSection('home')">Home</a>
                    <a href="#" onclick="showSection('query')">Medical Query</a>
                    <a href="#" onclick="showSection('dashboard')">Dashboard</a>
                    <a href="#" onclick="showSection('about')">About</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <section class="hero">
                <h1>AI-Powered Healthcare Communication</h1>
                <p>Secure platform connecting patients and healthcare providers through AI-assisted consultations with professional medical oversight.</p>
                
                <div>
                    <button onclick="showSection('query')" class="btn btn-primary">Submit Medical Query</button>
                    <button onclick="showSection('dashboard')" class="btn btn-medical">View Dashboard</button>
                    <button onclick="initializeBackend()" class="btn btn-ai">Connect to AI Backend</button>
                </div>
            </section>

            <section class="status-demo">
                <span class="status-badge status-pending">Pending Review</span>
                <span class="status-badge status-ai-processing">AI Processing</span>
                <span class="status-badge status-approved">Doctor Approved</span>
            </section>

            <section class="features">
                <div class="card patient-card">
                    <h3>For Patients</h3>
                    <ul>
                        <li>Submit medical queries securely</li>
                        <li>Receive AI-assisted responses</li>
                        <li>Doctor-reviewed medical advice</li>
                        <li>Track your health history</li>
                        <li>Blockchain-secured records</li>
                    </ul>
                </div>

                <div class="card doctor-card">
                    <h3>For Healthcare Providers</h3>
                    <ul>
                        <li>Review AI-generated responses</li>
                        <li>Provide expert medical oversight</li>
                        <li>Efficient patient management</li>
                        <li>Access comprehensive histories</li>
                        <li>Secure communication platform</li>
                    </ul>
                </div>

                <div class="card ai-card">
                    <h3>AI Technology</h3>
                    <ul>
                        <li>Advanced medical knowledge base</li>
                        <li>Natural language processing</li>
                        <li>Symptom analysis and insights</li>
                        <li>Human oversight integration</li>
                        <li>Continuous learning system</li>
                    </ul>
                </div>
            </section>

            <!-- Medical Query Section -->
            <section id="querySection" class="query-section">
                <h2>Submit Medical Query</h2>
                <p style="color: var(--gray-600); margin-bottom: var(--space-6);">
                    Get AI-powered medical guidance using BaiChuan M2 32B via Novita AI API,
                    integrated with comprehensive patient context.
                </p>

                <form id="medicalQueryForm">
                    <div class="form-group">
                        <label class="form-label">Select Patient</label>
                        <select id="patientId" class="form-select" required>
                            <option value="">Choose a test patient...</option>
                            <option value="P001">P001 - Sarah Michelle Johnson (Type 2 Diabetes, 45y)</option>
                            <option value="P002">P002 - Michael David Rodriguez (Type 1 Diabetes, 19y)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Medical Query</label>
                        <textarea id="queryText" class="form-textarea" rows="4" required
                            placeholder="Describe your symptoms, concerns, or medical questions in detail. For testing, try: 'I've been feeling tired lately and my morning blood sugars are higher than usual. Should I be concerned?'"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Vital Signs (Optional)</label>
                        <div class="vitals-grid">
                            <div class="vital-input">
                                <label>Blood Glucose (mg/dL)</label>
                                <input type="number" id="bloodGlucose" placeholder="e.g., 180" step="1">
                            </div>
                            <div class="vital-input">
                                <label>Blood Pressure</label>
                                <input type="text" id="bloodPressure" placeholder="e.g., 140/90" pattern="[0-9]{2,3}/[0-9]{2,3}">
                            </div>
                            <div class="vital-input">
                                <label>Heart Rate (BPM)</label>
                                <input type="number" id="heartRate" placeholder="e.g., 85" min="40" max="200">
                            </div>
                            <div class="vital-input">
                                <label>Temperature (Â°C)</label>
                                <input type="number" id="temperature" placeholder="e.g., 37.2" step="0.1" min="35" max="42">
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: var(--space-4);">
                        <span id="submitText">Get AI Medical Guidance</span>
                        <span id="submitLoading" class="loading hidden">
                            <span class="loading-dots">
                                <span></span>
                                <span></span>
                                <span></span>
                            </span>
                            Processing with BaiChuan M2 32B...
                        </span>
                    </button>
                </form>

                <!-- Response Container -->
                <div id="responseContainer" class="response-container">
                    <div class="response-header">
                        <div>
                            <h3 style="color: var(--primary-blue); margin: 0;">AI Medical Response</h3>
                            <p style="margin: 0; color: var(--gray-600);">Powered by BaiChuan M2 32B via Novita AI</p>
                        </div>
                        <div>
                            <span id="responseStatus" class="status-badge status-ai-processing">Processing</span>
                            <span style="margin-left: var(--space-4); font-weight: 600; color: var(--gray-600);">
                                Safety Score: <span id="safetyScore" style="color: var(--primary-blue);">--</span>/100
                            </span>
                        </div>
                    </div>
                    <div id="responseContent" class="response-content"></div>
                </div>
            </section>

            <!-- Dashboard Section -->
            <section id="dashboardSection" class="dashboard-section">
                <h2>System Dashboard</h2>
                <p style="color: var(--gray-600); margin-bottom: var(--space-6);">
                    Real-time statistics from the TrustCareConnect backend canister.
                </p>

                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="totalPatients">--</h3>
                        <p>Total Patients</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalQueries">--</h3>
                        <p>Total Queries</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalDoctors">--</h3>
                        <p>Total Doctors</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="backendStatus">--</h3>
                        <p>Backend Status</p>
                    </div>
                </div>

                <div class="card">
                    <h3>Backend Health Check</h3>
                    <pre id="healthCheckContent" style="background: var(--gray-50); padding: var(--space-4); border-radius: 0.5rem; margin-top: var(--space-4); overflow-x: auto; font-family: 'JetBrains Mono', monospace;">Loading backend data...</pre>
                </div>
            </section>
        </div>
    </main>

    <!-- Connection Status -->
    <div id="connectionStatus" class="connection-status connecting">
        <span id="connectionText">Initializing...</span>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 TrustCareConnect. AI-Powered Healthcare with BaiChuan M2 32B via Novita AI API.</p>
        </div>
    </footer>

    <!-- Include modular JavaScript application -->
    <script type="module" src="js/app.js"></script>
</body>
</html>